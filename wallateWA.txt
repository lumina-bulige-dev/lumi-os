改ざん検知付き自己開示レポート仕様書 v0.1

この文書は、LUMINA BULIGE （以下「サービス」）が提供する「改ざん検知付き自己開示レポート」に関する最初のバージョンの仕様書です。プロダクト実装の指針となるよう、目的、ユーザー導線、ステータス定義、API仕様、プロトコル、セキュリティ運用ならびに仕様更新方針をまとめています。

1 目的と非目的
	•	目的：利用者が自分の金融状況や行動履歴を手入力でレポートし、その内容に対して改ざん検知付きの署名を付与することで、第三者がレポートの整合性を自律的に検証できることを目指します。署名付きレポートは、検証機構を用いることで「改ざんされていないこと」を証明します。
	•	非目的：現在のフェーズでは銀行口座など外部金融機関とのデータ連携による真偽判定は行いません。入力された内容の真実性を保証する仕組みは開発範囲外です。
	•	前提：ユーザーはレポートを手入力しても構いません。ただし、署名はあくまで「改ざんされていないこと」を保証するものであり、内容の真実性を保証するものではないことを仕様書に明記します。暗号署名は、入力メッセージが改変されていないことと署名に用いられた秘密鍵の所有者が確かであることを検証者に示しますが ￼、内容が事実であるか否かまでは判断しません ￼。この点を根拠に、サービスは「改ざん検知」と「真実性の保証」を明確に分離します。

2 ユーザー導線
	1.	招待トークンの取得：管理者が発行した招待トークンが必要です。トークン取得用エンドポイント（後述のPOST /invite/issue）で招待を生成し、期限付きのトークン文字列と有効期限を受け取ります。
	2.	アプリで入力・発行：ユーザーはapp.luminabulige.comにアクセスし、招待トークンを入力後、自身のレポートを入力します。完了後、アプリはPOST /proofsエンドポイントを呼び出して署名付きレポート（proof）を生成します。レスポンスにはproofIdが返され、レポートページ上に証明リンクが付与されます。
	3.	検証ページへ移動：レポートを閲覧する第三者は、CIAページ（月次レポート一覧）でproofId付きリンクをクリックするとverifyページに遷移します。verifyページではクエリパラメータで渡されたproofIdを用いて検証APIを呼び出し、検証結果を表示します。
	4.	結果表示と登録：検証APIからの結果がOKであればβ版機能の利用や正式登録が解禁されます。NG、REVOKED、UNKNOWNの場合は利用できません。検証結果とともにレポート内容を表示し、ステータスに応じたメッセージをユーザーに提示します。

3 ステータス定義

署名付きレポートの検証結果は以下の4種類に分類します。検証側は常に最新版の失効リストを参照し、ステータスを付与します。