(()=>{var e={};e.id=838,e.ids=[838],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3937:(e,o,r)=>{"use strict";r.r(o),r.d(o,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>g,tree:()=>d}),r(215),r(1506),r(5866);var t=r(3191),i=r(8716),n=r(7922),l=r.n(n),s=r(5231),a={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(a[e]=()=>s[e]);r.d(o,a);let d=["",{children:["v",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,215)),"/home/runner/work/lumi-os/lumi-os/luminabulige_app/app/v/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,1506)),"/home/runner/work/lumi-os/lumi-os/luminabulige_app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/runner/work/lumi-os/lumi-os/luminabulige_app/app/v/page.tsx"],p="/v/page",u={require:r,loadChunk:()=>Promise.resolve()},g=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/v/page",pathname:"/v",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1327:()=>{},6544:(e,o,r)=>{Promise.resolve().then(r.bind(r,1576))},7888:(e,o,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},1576:(e,o,r)=>{"use strict";r.d(o,{default:()=>g});var t=r(326),i=r(7577),n=r(5047);let l={radius:{sm:10,md:14,lg:18,pill:999},space:{xs:6,sm:10,md:14,lg:18,xl:24,xxl:32},font:{mono:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",ui:"system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, sans-serif"},color:{bg:"#0B1020",card:"#FFFFFF",soft:"#F9FAFB",border:"#E5E7EB",text:"#111827",sub:"#6B7280",weak:"#9CA3AF",ok:"#065F46",okBg:"#ECFDF5",ng:"#9A3412",ngBg:"#FFF7ED",rev:"#7C2D12",revBg:"#FEF2F2",unk:"#1F2937",unkBg:"#F3F4F6",link:"#2563EB"},shadow:{card:"0 14px 40px rgba(0,0,0,0.12)",soft:"0 10px 24px rgba(0,0,0,0.08)"}},s={OK:"署名が一致しました",NG:"署名が一致しませんでした",REVOKED:"発行元が無効化しています",UNKNOWN:"鍵情報が取得できませんでした"};function a(e,o=10,r=6){return e?e.length<=o+r+3?e:`${e.slice(0,o)}…${e.slice(-r)}`:""}function d(e){let o=function e(o){if(null==o)return null;if("number"==typeof o){let e=new Date(o<1e12?1e3*o:o);return isNaN(e.getTime())?null:e}if("string"==typeof o){if(/^\d+$/.test(o))return e(Number(o));let r=new Date(o);return isNaN(r.getTime())?null:r}return null}(e);if(!o)return"-";try{return new Intl.DateTimeFormat("ja-JP",{dateStyle:"medium",timeStyle:"short",timeZone:"Asia/Tokyo"}).format(o)}catch{return o.toISOString()}}async function c(e){if(e)try{return await navigator.clipboard.writeText(e),!0}catch{try{let o=document.createElement("textarea");return o.value=e,o.style.position="fixed",o.style.left="-9999px",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o),!0}catch{return!1}}}function p(e){let[o,r]=(0,i.useState)(!1),n=!e.value;return t.jsx("button",{onClick:async()=>{e.value&&await c(e.value)&&(r(!0),setTimeout(()=>r(!1),900))},disabled:n,style:{appearance:"none",border:`1px solid ${l.color.border}`,background:"#FFFFFF",borderRadius:l.radius.pill,padding:"6px 10px",fontSize:12,fontWeight:800,cursor:n?"not-allowed":"pointer",color:n?l.color.weak:l.color.text},title:e.value?`Copy ${e.label??""}`:"コピー対象がありません",children:o?"Copied":"Copy"})}function u(e){return(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr auto",gap:10,alignItems:"start"},children:[t.jsx("div",{style:{color:l.color.sub,fontSize:13,paddingTop:2},children:e.k}),t.jsx("div",{style:{color:l.color.text},children:e.v}),t.jsx("div",{children:e.right})]})}function g(){let e=(0,n.useSearchParams)(),o=(0,i.useMemo)(()=>{let o=e.get("proofId")||void 0,r=e.get("hash")||void 0;return{proofId:o,hash:r,sig:e.get("sig")||void 0,kid:e.get("kid")||void 0,alg:e.get("alg")||void 0}},[e]),[r,c]=(0,i.useState)(!1),[g,h]=(0,i.useState)(null),[m,f]=(0,i.useState)(null),[x,y]=(0,i.useState)(null),b=(0,i.useMemo)(()=>{if(!g?.result)return null;let e=String(g.result).toUpperCase();return"OK"===e||"NG"===e||"REVOKED"===e||"UNKNOWN"===e?e:null},[g]),v="NG"===b||"UNKNOWN"===b,j=(0,i.useMemo)(()=>"",[o.proofId,o.hash,o.sig,o.kid,o.alg]),k=(0,i.useMemo)(()=>{if(!g)return"";let e=["Proof Verification Issue","",`proofId: ${o.proofId??"-"}`,`result: ${String(g.result??"-")}`,`error: ${g.error??"-"}`,`verified: ${"boolean"==typeof g.verified?String(g.verified):"-"}`,`verifiedAt(JST): ${x?d(x):"-"}`,"",`page_url: ${j||"-"}`,"",`kid: ${o.kid??g.kid??"-"}`,`alg: ${o.alg??g.alg??"-"}`,`hash: ${o.hash??g.payload_hash_b64u??"-"}`,"","response_json:",JSON.stringify(g,null,2),"","Please advise next steps."].join("\n");return`mailto:contact@luminabulige.com?subject=${encodeURIComponent("Proof Verification Issue")}&body=${encodeURIComponent(e)}`},[g,o,x,j]);async function F(){f(null),c(!0);try{let e=new URLSearchParams;o.proofId&&e.set("proofId",o.proofId),o.hash&&e.set("hash",o.hash),o.sig&&e.set("sig",o.sig),o.kid&&e.set("kid",o.kid),o.alg&&e.set("alg",o.alg);let r=await fetch(`/api/verify?${e.toString()}`,{method:"GET"}),t=await r.json();h(t),y(Date.now()),r.ok||f(t?.error?`${t.error}`:`HTTP ${r.status}`)}catch(e){f(e?.message||String(e)),h(null),y(Date.now())}finally{c(!1)}}let S=!!(o.proofId||o.hash&&o.sig&&o.kid&&o.alg),_=!!g?.proof,w="boolean"==typeof g?.verified;return(0,t.jsxs)(t.Fragment,{children:[t.jsx("style",{children:`
        @media print {
          details { display: block !important; }
          details > summary { display: none !important; }
          details:not([open]) > *:not(summary) { display: block !important; }

          pre {
            overflow: visible !important;
            white-space: pre-wrap !important;
            word-break: break-word !important;
          }

          /* PDFに残したいボタンは class で除外する */
          button:not(.print-keep) { display: none !important; }
          a { text-decoration: none !important; }
        }
      `}),t.jsx("main",{style:{minHeight:"100vh",background:l.color.bg,padding:l.space.xxl,fontFamily:l.font.ui},children:(0,t.jsxs)("div",{style:{maxWidth:860,margin:"0 auto"},children:[(0,t.jsxs)("div",{style:{marginBottom:l.space.lg},children:[t.jsx("div",{style:{color:"rgba(255,255,255,0.78)",fontSize:12,letterSpacing:.9},children:"LUMINA BULIGE"}),t.jsx("h1",{style:{color:"#FFFFFF",margin:"6px 0 0",fontSize:28,lineHeight:1.2},children:"Proof Verification"}),t.jsx("div",{style:{color:"rgba(255,255,255,0.72)",marginTop:10,fontSize:14,lineHeight:1.7},children:"QR / API の値を用いて署名検証し、結果と根拠を提示します（監査・問い合わせ前提の表示）。"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:l.space.md,flexWrap:"wrap",marginBottom:l.space.lg,alignItems:"center"},children:[t.jsx("button",{onClick:F,disabled:!S||r,style:{appearance:"none",border:`1px solid ${l.color.border}`,background:S?"#FFFFFF":"rgba(255,255,255,0.78)",borderRadius:l.radius.md,padding:"11px 14px",fontWeight:900,cursor:S&&!r?"pointer":"not-allowed",boxShadow:l.shadow.soft,letterSpacing:.2},title:S?"":"proofId または (hash,sig,kid,alg) が必要です",children:r?"Verifying…":"検証する"}),t.jsx("div",{style:{color:"rgba(255,255,255,0.72)",fontSize:12,lineHeight:1.6},children:(0,t.jsxs)("div",{style:{fontFamily:l.font.mono},children:["proofId=",o.proofId?a(o.proofId,10,6):"-"," / hash=",o.hash?"yes":"no"," / sig=",o.sig?"yes":"no"," / kid=",o.kid?a(o.kid,10,6):"-"," / alg=",o.alg??"-"]})})]}),(0,t.jsxs)("section",{style:{border:"1px solid rgba(229,231,235,0.9)",borderRadius:l.radius.lg,padding:l.space.xl,background:l.color.card,boxShadow:l.shadow.card},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[(0,t.jsxs)("div",{children:[t.jsx("div",{style:{fontSize:12,color:l.color.sub,marginBottom:8,letterSpacing:.3},children:"結果"}),b?(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[t.jsx("span",{style:{...function(e){switch(e){case"OK":return{color:l.color.ok,background:l.color.okBg,border:"1px solid #A7F3D0"};case"NG":return{color:l.color.ng,background:l.color.ngBg,border:"1px solid #FED7AA"};case"REVOKED":return{color:l.color.rev,background:l.color.revBg,border:"1px solid #FECACA"};case"UNKNOWN":return{color:l.color.unk,background:l.color.unkBg,border:`1px solid ${l.color.border}`}}}(b),padding:"6px 10px",borderRadius:l.radius.pill,fontWeight:900,fontSize:12,letterSpacing:.6},children:b}),t.jsx("span",{style:{color:l.color.text,fontWeight:900,fontSize:16},children:s[b]}),w&&(0,t.jsxs)("span",{style:{marginLeft:6,padding:"6px 10px",borderRadius:l.radius.pill,border:`1px solid ${l.color.border}`,background:l.color.soft,fontSize:12,fontWeight:900,color:l.color.text},children:["verified: ",String(g?.verified)]})]}):t.jsx("div",{style:{color:l.color.sub},children:"まだ検証していません（上の「検証する」を押してください）"}),t.jsx("div",{style:{marginTop:l.space.sm,display:"flex",gap:10,flexWrap:"wrap"},children:(0,t.jsxs)("div",{style:{color:l.color.sub,fontSize:12},children:["検証時刻（JST）: ",t.jsx("span",{style:{color:l.color.text,fontWeight:900},children:x?d(x):"-"})]})}),j&&t.jsx("div",{style:{marginTop:l.space.sm},children:t.jsx(u,{k:"verify_url",v:t.jsx("span",{style:{fontFamily:l.font.mono},children:a(j,42,14)}),right:t.jsx(p,{value:j,label:"verify_url"})})}),m&&(0,t.jsxs)("div",{style:{marginTop:l.space.md,background:l.color.soft,border:`1px solid ${l.color.border}`,borderRadius:l.radius.md,padding:l.space.md,color:l.color.text},children:[t.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"エラー"}),t.jsx("div",{style:{fontFamily:l.font.mono,fontSize:12,whiteSpace:"pre-wrap"},children:m})]})]}),v&&g&&t.jsx("div",{style:{marginTop:10,marginBottom:10,color:l.color.sub,fontSize:12,lineHeight:1.6},children:"問い合わせボタンを押すと、検証に必要な情報（proofId / hash / kid / alg / 結果 / 応答JSON）が本文に自動で入ります。"}),v&&g&&t.jsx("a",{href:k,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:8,padding:"10px 12px",borderRadius:l.radius.md,border:`1px solid ${l.color.border}`,background:"#FFFFFF",color:l.color.link,fontWeight:900,textDecoration:"none",whiteSpace:"nowrap"},children:"発行元に問い合わせ"})]}),(0,t.jsxs)("div",{style:{marginTop:l.space.xl},children:[t.jsx("div",{style:{fontSize:12,color:l.color.sub,marginBottom:l.space.sm,letterSpacing:.3},children:"Proof 情報"}),t.jsx("div",{style:{background:l.color.soft,border:`1px solid ${l.color.border}`,borderRadius:l.radius.md,padding:l.space.lg},children:_?(0,t.jsxs)("div",{style:{display:"grid",gap:10},children:[t.jsx(u,{k:"proof_id",v:t.jsx("span",{style:{fontFamily:l.font.mono},children:g?.proof?.proof_id??"-"}),right:t.jsx(p,{value:g?.proof?.proof_id??null,label:"proof_id"})}),t.jsx(u,{k:"期間",v:(0,t.jsxs)("span",{children:[g?.proof?.range?.from??"-"," 〜 ",g?.proof?.range?.to??"-"]})}),t.jsx(u,{k:"作成",v:t.jsx("span",{children:d(g?.proof?.created_at_ts)})}),t.jsx(u,{k:"カウント",v:(0,t.jsxs)("span",{children:["SAFE ",g?.proof?.counts?.SAFE??0," / WARNING ",g?.proof?.counts?.WARNING??0," / DANGER"," ",g?.proof?.counts?.DANGER??0," / total ",g?.proof?.counts?.total??0]})}),t.jsx(u,{k:"ruleset_version",v:t.jsx("span",{style:{fontFamily:l.font.mono},children:g?.proof?.ruleset_version??"-"})}),t.jsx(u,{k:"kid",v:t.jsx("span",{style:{fontFamily:l.font.mono},children:g?.proof?.kid??g?.kid??"-"}),right:t.jsx(p,{value:g?.proof?.kid??g?.kid??null,label:"kid"})}),t.jsx(u,{k:"alg",v:t.jsx("span",{style:{fontFamily:l.font.mono},children:g?.proof?.alg??g?.alg??"-"}),right:t.jsx(p,{value:g?.proof?.alg??g?.alg??null,label:"alg"})}),t.jsx(u,{k:"payload_hash_b64u",v:t.jsx("span",{style:{fontFamily:l.font.mono},children:g?.proof?.payload_hash_b64u??g?.payload_hash_b64u??"-"}),right:t.jsx(p,{value:g?.proof?.payload_hash_b64u??g?.payload_hash_b64u??null,label:"payload_hash_b64u"})})]}):(0,t.jsxs)("div",{style:{color:l.color.sub,lineHeight:1.7},children:["Proof 情報が取得できませんでした。",t.jsx("br",{}),t.jsx("span",{style:{color:l.color.weak},children:"proofId 付きURLでの検証が最短で確実です（例: /v?proofId=xxxx）"})]})})]}),g&&t.jsx("div",{style:{marginTop:l.space.lg},children:(0,t.jsxs)("details",{children:[t.jsx("summary",{style:{cursor:"pointer",color:l.color.link,fontWeight:900},children:"技術詳細（レスポンスJSON）"}),t.jsx("pre",{style:{marginTop:l.space.sm,padding:l.space.md,borderRadius:l.radius.md,border:`1px solid ${l.color.border}`,background:"#0F172A",color:"#E5E7EB",overflowX:"auto",fontSize:12,lineHeight:1.5},children:JSON.stringify(g,null,2)})]})})]}),(0,t.jsxs)("div",{style:{color:"rgba(255,255,255,0.62)",fontSize:12,marginTop:l.space.lg,lineHeight:1.7},children:["注意: NG / UNKNOWN の場合は、入力値の転記ミス、改ざん、鍵ローテーション等が原因になり得ます。",t.jsx("br",{}),"ここまで整ってると、言い訳じゃなくて「説明」になります（大事）。"]})]})})]})}},5047:(e,o,r)=>{"use strict";var t=r(7389);r.o(t,"useRouter")&&r.d(o,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(o,{useSearchParams:function(){return t.useSearchParams}})},1506:(e,o,r)=>{"use strict";r.r(o),r.d(o,{default:()=>n,metadata:()=>i});var t=r(9510);r(7272);let i={title:"LUMINA BULIGE",description:"Money Flow Stabilizer OS"};function n({children:e}){return t.jsx("html",{lang:"ja",children:t.jsx("body",{children:e})})}},215:(e,o,r)=>{"use strict";r.r(o),r.d(o,{default:()=>l});var t=r(9510),i=r(1159);let n=(0,r(8570).createProxy)(String.raw`/home/runner/work/lumi-os/lumi-os/luminabulige_app/app/v/VClient.tsx#default`);function l(){return t.jsx(i.Suspense,{fallback:t.jsx("div",{style:{padding:24},children:"Loading…"}),children:t.jsx(n,{})})}},7272:()=>{}};var o=require("../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[819],()=>r(3937));module.exports=t})();