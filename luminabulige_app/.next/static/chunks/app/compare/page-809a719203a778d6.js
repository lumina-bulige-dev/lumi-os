(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[266],{6443:function(e,t,s){Promise.resolve().then(s.bind(s,3670))},3670:function(e,t,s){"use strict";s.d(t,{default:function(){return o}});var l=s(7437),a=s(2265);let r="lumi_compare_v2",n={FIXED:["家賃","通信","サブスク","保険","ローン","税金","光熱費","その他固定費"],LIFE:["食費","日用品","交通","医療","衣類","交際","その他生活"],WORK:["ツール","学習","移動","備品","投資(自己)","その他仕事"],FUN:["娯楽","外食","趣味","旅行","ゲーム","ギャンブル(注意)","その他FUN"],OTHER:["立替","返金","寄付","不明","その他"]};function d(e){let t=6e4*new Date(e).getTimezoneOffset();return new Date(e-t).toISOString().slice(0,16)}function i(e){return e.toLocaleString("ja-JP",{maximumFractionDigits:0})}function o(){var e,t;let[s,o]=(0,a.useState)([]),[c,x]=(0,a.useState)(0),[m,u]=(0,a.useState)("EXPENSE"),[h,p]=(0,a.useState)("LIFE"),[b,g]=(0,a.useState)(n.LIFE[0]),[N,j]=(0,a.useState)(""),[v,f]=(0,a.useState)(""),[w,y]=(0,a.useState)("home"),[E,S]=(0,a.useState)(()=>d(Date.now()));(0,a.useEffect)(()=>{var e,t;g(null!==(t=null===(e=n[h])||void 0===e?void 0:e[0])&&void 0!==t?t:"その他")},[h]),(0,a.useEffect)(()=>{try{let e=localStorage.getItem(r);if(!e)return;let t=JSON.parse(e);t&&"object"==typeof t&&("number"==typeof t.openingBalance&&x(t.openingBalance),Array.isArray(t.logs)&&o(t.logs))}catch(e){}},[]),(0,a.useEffect)(()=>{try{localStorage.setItem(r,JSON.stringify({openingBalance:c,logs:s}))}catch(e){}},[c,s]);let C=(0,a.useMemo)(()=>{let e=[...s].sort((e,t)=>e.occurredAt-t.occurredAt),t=0,l=[];for(let s of e)"EXPENSE"===s.kind&&(t+=s.amount),l.push({ts:s.occurredAt,v:t});return 0===l.length&&l.push({ts:Date.now(),v:0}),l},[s]),D=(0,a.useMemo)(()=>{if(!C.length)return"";let e=C.map(e=>e.ts),t=C.map(e=>e.v),s=Math.min(...e),l=Math.max(...e),a=Math.max(...t);return C.map(e=>({x:l===s?0:(e.ts-s)/(l-s||1)*300,y:0===a?80:80-(e.v-0)/(a-0||1)*80})).map((e,t)=>"".concat(0===t?"M":"L").concat(e.x,",").concat(e.y)).join(" ")},[C]),k=(0,a.useMemo)(()=>{let e=s.filter(e=>"INCOME"===e.kind).reduce((e,t)=>e+t.amount,0),t=s.filter(e=>"EXPENSE"===e.kind).reduce((e,t)=>e+t.amount,0),l=c+e-t;return{incomesTotal:e,expensesTotal:t,balance:l}},[s,c]);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("header",{className:"space-y-1",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"Compare / Money Stabilizer（β）"}),(0,l.jsx)("p",{className:"text-slate-300 text-sm",children:"開始残高 + 入金/支出ログで「床」を管理する。"})]}),(0,l.jsxs)("section",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,l.jsxs)("div",{className:"flex items-baseline justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-sm text-slate-200 font-semibold",children:"累積支出グラフ"}),(0,l.jsxs)("div",{className:"text-xs text-slate-400",children:["最新：\xa5"," ",i(null!==(t=null===(e=C[C.length-1])||void 0===e?void 0:e.v)&&void 0!==t?t:0)]})]}),(0,l.jsxs)("svg",{viewBox:"0 0 300 80",className:"w-full h-24",preserveAspectRatio:"none",children:[(0,l.jsx)("defs",{children:(0,l.jsxs)("linearGradient",{id:"expenseFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,l.jsx)("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:"0.6"}),(0,l.jsx)("stop",{offset:"100%",stopColor:"#38bdf8",stopOpacity:"0"})]})}),(0,l.jsx)("line",{x1:"0",y1:"79",x2:"300",y2:"79",stroke:"rgba(148,163,184,0.4)",strokeWidth:"0.5"}),D&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"".concat(D," L300,80 L0,80 Z"),fill:"url(#expenseFill)"}),(0,l.jsx)("path",{d:D,fill:"none",stroke:"#38bdf8",strokeWidth:"2"})]})]})]}),(0,l.jsxs)("section",{className:"rounded-xl border border-white/10 bg-white/5 p-4 space-y-3",children:[(0,l.jsxs)("label",{className:"text-xs text-slate-300 block",children:["開始残高（必須）",(0,l.jsx)("input",{className:"mt-1 w-full rounded-lg bg-slate-950/60 border border-white/10 px-3 py-2",inputMode:"numeric",value:c,onChange:e=>x(Number(e.target.value))})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>u("EXPENSE"),className:"rounded-lg px-3 py-2 text-sm border ".concat("EXPENSE"===m?"bg-white text-slate-950":"border-white/15 bg-white/5 text-slate-200"),children:"支出"}),(0,l.jsx)("button",{type:"button",onClick:()=>u("INCOME"),className:"rounded-lg px-3 py-2 text-sm border ".concat("INCOME"===m?"bg-white text-slate-950":"border-white/15 bg-white/5 text-slate-200"),children:"入金"})]}),(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-5",children:[(0,l.jsxs)("div",{className:"md:col-span-1",children:[(0,l.jsx)("label",{className:"text-xs text-slate-300",children:"親カテゴリ"}),(0,l.jsx)("select",{className:"mt-1 w-full rounded-lg bg-slate-950/60 border border-white/10 px-3 py-2",value:h,onChange:e=>p(e.target.value),children:["FIXED","LIFE","WORK","FUN","OTHER"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"text-xs text-slate-300",children:"子カテゴリ"}),(0,l.jsx)("select",{className:"mt-1 w-full rounded-lg bg-slate-950/60 border border-white/10 px-3 py-2",value:b,onChange:e=>g(e.target.value),children:n[h].map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"md:col-span-1",children:[(0,l.jsx)("label",{className:"text-xs text-slate-300",children:"金額（JPY）"}),(0,l.jsx)("input",{className:"mt-1 w-full rounded-lg bg-slate-950/60 border border-white/10 px-3 py-2",placeholder:"例：1200",inputMode:"numeric",value:N,onChange:e=>j(e.target.value)})]}),(0,l.jsxs)("div",{className:"md:col-span-1",children:[(0,l.jsx)("label",{className:"text-xs text-slate-300",children:"場所"}),(0,l.jsxs)("select",{className:"mt-1 w-full rounded-lg bg-slate-950/60 border border-white/10 px-3 py-2",value:null!=w?w:"other",onChange:e=>y(e.target.value),children:[(0,l.jsx)("option",{value:"home",children:"home"}),(0,l.jsx)("option",{value:"work",children:"work"}),(0,l.jsx)("option",{value:"move",children:"move"}),(0,l.jsx)("option",{value:"other",children:"other"})]})]})]}),(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-5 items-end",children:[(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"text-xs text-slate-300",children:"発生時刻"}),(0,l.jsx)("input",{type:"datetime-local",className:"mt-1 w-full rounded-lg bg-slate-950/60 border border-white/10 px-3 py-2",value:E,onChange:e=>S(e.target.value)})]}),(0,l.jsx)("div",{className:"md:col-span-1",children:(0,l.jsx)("button",{className:"w-full rounded-lg border border-white/15 bg-white/10 px-3 py-2 hover:bg-white/15",onClick:()=>S(d(Date.now())),type:"button",children:"今"})}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"text-xs text-slate-300",children:"メモ（任意）"}),(0,l.jsx)("input",{className:"mt-1 w-full rounded-lg bg-slate-950/60 border border-white/10 px-3 py-2",placeholder:"例：深夜テンションでコンビニ",value:v,onChange:e=>f(e.target.value)})]})]}),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("button",{className:"rounded-lg bg-white text-slate-950 px-4 py-2 font-semibold",onClick:function(){let e=Number(N);if(!Number.isFinite(e)||e<=0)return;let t=Date.now(),s=function(e){let t=new Date(e).getTime();return Number.isFinite(t)?t:Date.now()}(E),l={id:"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():"id_".concat(Math.random().toString(16).slice(2),"_").concat(Date.now()),createdAt:t,occurredAt:s,kind:m,parent:h,child:b,amount:Math.round(e),memo:v.trim()?v.trim():void 0,placeTag:w};o(e=>[l,...e].sort((e,t)=>t.occurredAt-e.occurredAt)),j(""),f("")},type:"button",children:"追加"}),(0,l.jsxs)("div",{className:"ml-auto text-sm text-slate-200",children:["残高：",(0,l.jsxs)("span",{className:"font-mono",children:["\xa5 ",i(k.balance)]})]})]}),k.balance<0&&(0,l.jsx)("div",{className:"rounded-lg border border-red-500/30 bg-red-500/10 p-3 text-sm text-red-200 mt-2",children:"⚠️ 残高がマイナスです（床が抜けました）。入金 or 開始残高を確認してね。"}),(0,l.jsxs)("div",{className:"grid gap-2 md:grid-cols-3 text-sm mt-3",children:[(0,l.jsxs)("div",{className:"rounded-lg border border-white/10 bg-slate-950/40 p-3",children:[(0,l.jsx)("div",{className:"text-xs text-slate-300",children:"開始残高"}),(0,l.jsxs)("div",{className:"font-semibold",children:["\xa5 ",i(c)]})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-white/10 bg-slate-950/40 p-3",children:[(0,l.jsx)("div",{className:"text-xs text-slate-300",children:"入金合計"}),(0,l.jsxs)("div",{className:"font-semibold",children:["\xa5 ",i(k.incomesTotal)]})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-white/10 bg-slate-950/40 p-3",children:[(0,l.jsx)("div",{className:"text-xs text-slate-300",children:"支出合計"}),(0,l.jsxs)("div",{className:"font-semibold",children:["\xa5 ",i(k.expensesTotal)]})]})]})]}),(0,l.jsxs)("section",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,l.jsx)("h2",{className:"font-semibold mb-3",children:"ログ"}),0===s.length?(0,l.jsx)("p",{className:"text-slate-300 text-sm",children:"まだログがない。まず1件、現実世界から拾ってこい\uD83E\uDEF3\uD83C\uDF0D"}):(0,l.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,l.jsxs)("div",{className:"rounded-lg border border-white/10 bg-slate-950/40 p-3 flex items-center gap-3",children:[(0,l.jsxs)("div",{className:"min-w-[100px] text-xs text-slate-300",children:[e.kind,(0,l.jsx)("div",{className:"text-slate-400",children:new Date(e.occurredAt).toLocaleString("ja-JP")})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"font-semibold",children:[e.parent," / ",e.child,e.placeTag?(0,l.jsxs)("span",{className:"ml-2 text-xs text-slate-400",children:["(",e.placeTag,")"]}):null]}),e.memo?(0,l.jsx)("div",{className:"text-xs text-slate-300 mt-1",children:e.memo}):null]}),(0,l.jsx)("div",{className:"text-right",children:(0,l.jsxs)("div",{className:"font-bold",children:["\xa5 ",i(e.amount)]})})]},e.id))})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=6443)}),_N_E=e.O()}]);